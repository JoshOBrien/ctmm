<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Specify, fit, and select continuous-time movement models — ctmm • ctmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Specify, fit, and select continuous-time movement models — ctmm" />

<meta property="og:description" content="These functions allow one to propose hypothethical movement models (with initial estimates), fit those models to the data, and select among those models via an information criteria.
The fitting functions wrap around optim and ctmm.loglike to fit continuous-time movement models to 2D animal tracking data as described in Fleming et al (2014) and Fleming et al (2015), and Fleming et al (2017)." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ctmm-initiative/ctmm">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Specify, fit, and select continuous-time movement models</h1>
    
    <div class="hidden name"><code>ctmm.fit.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions allow one to propose hypothethical movement models (with initial estimates), fit those models to the data, and select among those models via an information criteria.
The fitting functions wrap around <code>optim</code> and <code>ctmm.loglike</code> to fit continuous-time movement models to 2D animal tracking data as described in Fleming et al (2014) and Fleming et al (2015), and Fleming et al (2017).</p>
    
    </div>

    <pre class="usage"><span class='fu'>ctmm</span>(<span class='kw'>tau</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>isotropic</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>range</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>circle</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>error</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>axes</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"x"</span>,<span class='st'>"y"</span>),<span class='no'>...</span>)

<span class='fu'>ctmm.loglike</span>(<span class='no'>data</span>,<span class='no'>CTMM</span>,<span class='kw'>REML</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>profile</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>zero</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='fu'>ctmm.fit</span>(<span class='no'>data</span>,<span class='kw'>CTMM</span><span class='kw'>=</span><span class='fu'>ctmm</span>(),<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"ML"</span>,<span class='kw'>COV</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(),<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='fu'>ctmm.select</span>(<span class='no'>data</span>,<span class='no'>CTMM</span>,<span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>level</span><span class='kw'>=</span><span class='fl'>0.99</span>,<span class='kw'>IC</span><span class='kw'>=</span><span class='st'>"AICc"</span>,<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tau</th>
      <td><p>Array of autocorrelation timescales explained below.</p></td>
    </tr>
    <tr>
      <th>isotropic</th>
      <td><p>A Boolean denoting whether or not the animal's covariance is circular or elliptical.</p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>A Boolean denoting whether or not the movement model has a finite range.</p></td>
    </tr>
    <tr>
      <th>circle</th>
      <td><p>The period it takes the animal to stochastically circle its mean location.</p></td>
    </tr>
    <tr>
      <th>error</th>
      <td><p>A Boolean denoting whether or not to use annotated telemetry error estimates or an estimate of the error's standard deviation if the data are not annotated with error estimates or when \(HDOP=1\).</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>Spatial dimensions of the movement model.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Timeseries data represented as a <code>telemetry</code> object.</p></td>
    </tr>
    <tr>
      <th>CTMM</th>
      <td><p>A <code>ctmm</code> movement-model object containing the initial parameter guesses conforming to the basic structure of the model hypothesis. <code>ctmm.select</code> can accept a list of such objects.</p></td>
    </tr>
    <tr>
      <th>REML</th>
      <td><p>Use residual maximum likelihood if <code>TRUE</code>. Not recommended.</p></td>
    </tr>
    <tr>
      <th>profile</th>
      <td><p>Analytically solve for as many covariance parameters as possible.</p></td>
    </tr>
    <tr>
      <th>zero</th>
      <td><p>Calculates \(\log(likelihood) - zero\), instead of just \(\log(likelihood)\), in a way that maintains numerical precision if the constant <code>zero</code> is close to the log likelihood. Used internally by <code>ctmm.fit</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Return additional information. See "Value" below.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Fitting method to use: <code>"ML"</code>, <code>"HREML"</code>, <code>"pREML"</code>, <code>"pHREML"</code>, or <code>"REML"</code>. See "Description" below.</p></td>
    </tr>
    <tr>
      <th>COV</th>
      <td><p>Estimate the autocorrelation parameter covariance matrix.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>An optional argument list with standardized numerical arguments.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>Report progress updates.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Attempt to simplify a model if a feature's non-existence falls within this level of confidence interval.</p></td>
    </tr>
    <tr>
      <th>IC</th>
      <td><p>Information criteria used. Only <code>"AICc"</code> is currently supported.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to <code>ctmm.fit</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Model fitting and selection first requires a prototype model with guesstimated parameters (i.e., Brownian motion with a particular diffusion rate).
The initial <code>ctmm</code> parameter guess can be generated by the output of <code>ctmm.guess</code>, <code>variogram.fit</code> or manually specified with the function <code>ctmm(...)</code>, where the argument <code>tau</code> is explained below and additonal model options described in <code>vignette("ctmm")</code>.</p>
<p>By default, <code>tau</code> is an ordered array of autocorrelation timescales.
If <code>length(tau)==0</code>, then an IID bi-variate Gaussian model is fit to the data.
If <code>length(tau)==1</code>, then an Ornstein-Uhlenbeck (OU) model (Brownian motion restricted to a finite home range) is fit the data, where <code>tau</code> is the position autocorrelation timescale. <code>tau=Inf</code> then yields Brownian motion (BM).
If <code>length(tau)==2</code>, then the OUF model (continuous-velocity motion restricted to a finite home range) is fit to the data, where <code>tau[1]</code> is again the position autocorrelation timescale and <code>tau[2]</code> is the velocity autocorrelation timescale. <code>tau[1]=Inf</code> then yields integrated Ornstein-Uhlenbeck (IOU) motion, which is a spatially unrestricted continuous-velocity process.</p>
<p>The potential fitting methods---maximum likelihood (<code>ML</code>), residual maximum likelihood (<code>REML</code>), perturbative REML (<code>pREML</code>), hybrid REML (<code>HREML</code>), and perturbative hybrid REML (<code>pHREML</code>)---are described in Fleming et al (2018). In general, <code>pHREML</code> is the best method, though when parameter estimates lie near boundaries it can fail, in which case <code>ctmm.fit</code> will fall back to <code>HREML</code>, as reported by the <code>method</code> slot of the resulting fit object.</p>
<p>The <code>control</code> list can take the folowing arguments, with defaults shown:</p><dl class='dl-horizontal'>
<dt><code>method="Nelder-Mead"</code></dt><dd><p><code>optim</code> method for multiple parameters.</p></dd>
<dt><code>precision=1/2</code></dt><dd><p>Fraction of machine numerical precision to target in the maximized likelihood value. MLEs will necessarily have half this precision. On most computers, <code>precision=1</code> is approximately 16 decimal digits of precision for the likelihood and 8 for the MLEs.</p></dd>
<dt><code>maxit=.Machine$integer.max</code></dt><dd><p>Maximum number of iterations allowed for optimization.</p></dd>
</dl>
    <p>Model selection in <code>ctmm.select</code> proceeds by first fitting the initial model guess, and then attempting to simplify the autocorrelation model and complexify the deterministic (mean) model until the information criteria fails to improve. The intent of working in these directions is to avoid fitting trends to autocorrelation.
Note that simpler models in a nested hierarchy will only be attempted if they appear credible, which can be adjusted with the <code>level</code> argument. <code>level=1</code> will, therefore, always attempt a simpler model.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>ctmm</code> returns a prototype <code>ctmm</code> movement-model object.
By default, <code>ctmm.loglike</code> returns the log-likelihood of the model <code>CTMM</code>.
<code>ctmm.fit</code> (and <code>ctmm.loglike</code> with <code>verbose=TRUE</code>) returns the maximum likelihood <code>ctmm</code> movement-model object with all of the components of <code>CTMM</code> plus the components listed below.
<code>ctmm.select</code> returns the best model by default or the complete list of attempted models if <code>verbose=TRUE</code>.</p><dl class='dl-horizontal'>
<dt><code>AICc</code></dt><dd><p>The approximate corrected Akaike information criterion for multivariate distributions with variable numbers of unknown mean and (structured) covariance parameters (Burnham &amp; Anderson, Eq. 7.91). This formula is only exact for IID data.</p></dd>
<dt><code>loglike</code></dt><dd><p>The log-likelihood.</p></dd>
<dt><code>sigma</code></dt><dd><p>The maximum likelihood variance/covariance estimate (possibly debiased). For the endlessly diffusing BM and IOU processes, this is instead the diffusion rate estimate.</p></dd>
<dt><code>mu</code></dt><dd><p>The maximum likelihood stationary mean vector estimate.</p></dd>
<dt><code>COV.mu</code></dt><dd><p>The covariance matrix of the vector <code>mu</code>, assuming that the point estimate <code>sigma</code> is good.</p></dd>
<dt><code>DOF.mu</code></dt><dd><p>The effective number of degrees of freedom in the estimate of <code>mu</code>, assuming that the point estimate of <code>tau</code> is good. This can be much smaller than <code>length(data$t)</code> if the data are autocorrelated.</p></dd>
<dt><code>COV</code></dt><dd><p>Covariance of the autocovariance parameter estimate vector <code>c(sigma,tau,circle)</code>, as derived (asymptotically) from the <code>hessian</code> of the log-likelihood function, and where <code>sigma</code> is parameterized in terms of its standard <code>area</code>, <code>eccentricity</code>, and <code>angle</code> of orientation. Typically, <code>sigma</code>'s <code>area</code> parameter is extremely correlated to <code>tau[1]</code>, and sequential components of <code>tau</code> are slightly correlated.</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>K. P. Burnham, D. R. Anderson.
Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach.
Springer, 2nd edition (2003).</p>
<p>C. H. Fleming, J. M. Calabrese, T. Mueller, K.A. Olson, P. Leimgruber, W. F. Fagan.
From fine-scale foraging to home ranges: A semi-variance approach to identifying movement modes across spatiotemporal scales.
<a href='http://www.jstor.org/discover/10.1086/675504'>The American Naturalist, 183:5, E154-E167 (2014)</a>.</p>
<p>C. H. Fleming, Y. Subasi, J. M. Calabrese.
A maximum-entropy description of animal movement.
<a href='http://journals.aps.org/pre/abstract/10.1103/PhysRevE.91.032107'>Physical Review E, 91, 032107 (2015)</a>.</p>
<p>C. H. Fleming, D. Sheldon, E. Gurarie, W. F. Fagan, S. LaPoint, J. M. Calabrese.
Kálmán filters for continuous-time movement models.
<a href='http://www.sciencedirect.com/science/article/pii/S1574954117301115'>Ecological Informatics, 40, 8-21 (2017)</a>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Fitting without telemetry errors involves fewer parameters and is much faster than fitting with telemetry errors, as the variance/covariance can be profiled analytically without numerical optimization.
Therefore, fitting without telemetry errors, if possible, can provide improved initial estimates of <code>tau</code> and <code>sigma</code> for later fitting with telemetry errors.</p>
<p>The default <code>optim</code> method here is <code>"Nelder-Mead"</code> with the largest allowable number of maximum iterations. Annecdotally, the faster <code>"BFGS"</code> and <code>"L-BFGS-B"</code> methods often perform poorly on these types of problems.
However, Nelder Mead is not ideal and you may want to attempt a second fit, using the first fit as its initial guess.</p>
<p>The AICs of endlessly diffusing models like BM and IOU cannot be easily compared to the AICs of range resident models like bivariate Gaussian, OU, and OUF. Endlessly diffusing models have to be conditioned off of an initial state, which we derive in <code>ctmm</code> by taking the large range limit of a range-restricted process. I.e., BM is the limit OU(<code>Inf</code>) and IOU(<code>tau</code>) is the limit OUF(<code>Inf</code>,<code>tau</code>). Using comparable likelihood functions gives up statistical efficiency and the objective prior. Moreover, comparing conditional likelihoods---with the objective prior taken from the joint likelihood---does not appear to select the true model with a likelihood ratio test. Therefore, there does not appear to be any obvious way to select between range resident and endlessly diffusing movement models.</p>
<p>Prior to v0.3.6, the univariate AICc formula was (mis)used, with the full parameter count treated as degrees of freedom in the mean. As of v.0.3.6, the mean and autocovariance parameters are treated separately in the approximate multivariate AICc formula (Burnham &amp; Anderson, Eq. 7.91). Still, this improved formula is only exact for IID data.</p>
<p>Prior to v0.3.2, <code>ctmm.select</code> would consider every possible model.
This is no longer feasible with current versions of <code>ctmm</code>, as the number of possible models has grown too large.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ctmm.boot.html'>ctmm.boot</a></code>, <code><a href='variogram.fit.html'>ctmm.guess</a></code>, <code>optim</code>, <code><a href='summary.ctmm.html'>summary.ctmm</a></code>, <code><a href='variogram.fit.html'>variogram.fit</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load package and data</span>
<span class='fu'>library</span>(<span class='no'>ctmm</span>)
<span class='fu'>data</span>(<span class='no'>buffalo</span>)
<span class='no'>Cilla</span> <span class='kw'>&lt;-</span> <span class='no'>buffalo</span>$<span class='no'>Cilla</span>

<span class='no'>GUESS</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='variogram.fit.html'>ctmm.guess</a></span>(<span class='no'>Cilla</span>,<span class='kw'>interactive</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>FIT</span> <span class='kw'>&lt;-</span> <span class='fu'>ctmm.fit</span>(<span class='no'>Cilla</span>,<span class='no'>GUESS</span>)

<span class='co'># some human-readable information</span>
<span class='fu'>summary</span>(<span class='no'>FIT</span>)</div><div class='output co'>#&gt; $DOF
#&gt;     mean     area 
#&gt; 11.54854 22.49909 
#&gt; 
#&gt; $CI
#&gt;                                 low        ML      high
#&gt; area (square kilometers) 234.954080 372.73449 541.79530
#&gt; tau position (days)        4.039193   6.92318  11.86634
#&gt; tau velocity (minutes)    39.636583  42.14108  44.80384
#&gt; speed (kilometers/day)    13.818785  14.05342  14.28799
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     C. H. Fleming and G. Péron. 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

